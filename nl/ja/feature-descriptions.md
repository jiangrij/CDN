---

copyright:
  years: 2018, 2019
lastupdated: "2019-05-21"

keywords: features, descriptions, metrics, multiple, origins, mapping, time to live, purge, cached, content, key, stale, https, geographical, access, protocol, compression, video, hotlink

subcollection: CDN

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:note: .note}
{:download: .download}
{:DomainName: data-hd-keyref="DomainName"}

# 機能の説明
{: #feature-descriptions}

このページでは、Akamai を採用した {{site.data.keyword.cloud}} CDN に含まれる機能の多くを取り上げて説明します。

## ホスト・サーバー・オリジンのサポート
{: #host-server-origin-support}

IBM Cloud Content Delivery Network (CDN) は、オリジンのホスト名、プロトコル、ポート番号、およびオプションでコンテンツの提供元のパスを指定することにより、ホスト・サーバー・オリジンからコンテンツを提供するように構成することができます。 デフォルトのパスは `/*` です。 プロトコルは HTTP、HTTPS、またはその両方を設定できます。 Akamai がサポートするのは特定のポート番号のみです。 サポートされるポート番号またはポート範囲については、『[よくある質問](docs/infrastructure/CDN?topic=CDN-faqs#are-there-any-restrictions-on-what-http-and-https-port-numbers-are-allowed-for-akamai-)』を参照してください。

## オブジェクト・ストレージ・オリジンのサポート
{: #object-storage-file-support}

エンドポイント、バケット名、プロトコル、およびポートを指定することによって、オブジェクト・ストレージ・エンドポイントからのコンテンツを提供するように IBM Cloud CDN を構成できます。 オプションで、ファイル拡張子のリストを、その拡張子を持つファイルのキャッシングのみを許可するように指定することができます。 バケット内のすべてのオブジェクトに、匿名読み取り権限または公開読み取り権限を設定する必要があります。

[CDN を使用した IBM Cloud Object Storage のセットアップ方法](/docs/tutorials?topic=solution-tutorials-static-files-cdn#static-files-cdn)に関するチュートリアルに、詳しい説明があります。

## 明確なパスを使用した複数オリジンのサポート
{: #support-for-multiple-origins-with-distinct-paths}

異なるオリジン・サーバーから特定のコンテンツを配信したい場合があります。 例えば、異なるオリジン・サーバーから提供される特定の写真やビデオが必要だとします。 IBM Cloud CDN は、複数のパスを使用した複数のオリジン・サーバーをセットアップするオプションを提供します。 これにより、データの保管方法と保管場所が柔軟に決定できます。 オリジン・サーバー用のパスは、CDN について固有でなければなりません。 オリジン・サーバー自体は、固有である必要はありません。

## パスベースの CDN マッピング
{: #path-based-cdn-mappings}

IBM Cloud CDN の作成時にオリジン・サーバーのディレクトリー・パスを提供することで、IBM Cloud CDN サービスを特定のディレクトリー・パスに制限することができます。 エンド・ユーザーは、そのディレクトリー・パス内のコンテンツにのみアクセスすることが許可されます。 例えば、CDN `www.example.com` がパス `/videos` を指定して作成された場合、そこには `www.example.com/videos/*` から**のみ**アクセス可能になります。

## キャッシュ・コンテンツのパージ
{: #purge-cached-content}

IBM Cloud CDN は、キャッシュに入れられたコンテンツをエッジ・サーバーから便利に素早く削除 (パージ) する機能を提供します。 現時点では、パージはファイル・パスに対してのみ許可されます。 現行では、Akamai でのパージの実装では約 5 秒でファイルがパージされます。 この UI では、パージの履歴を表示することもでき、特定のパージ・パスをお気に入りとしてタグ付けすることもできます。

## 存続時間 (TTL)
{: #time-to-live-ttl}

存続時間は、エッジ・サーバーが特定のファイルまたはディレクトリー・パスのキャッシュ・コンテンツを保持する時間 (秒単位) を示します。CDN が最初に作成されるとき、パス `/\*` のグローバル存続時間 (TTL) がデフォルト時間 3600 秒で作成されます。 TTL の最小値は 0 秒で、最大値は 2147483647 秒です。 各項目で、TTL パスは CDN について固有でなければなりません。 複数のパスが特定のコンテンツに一致する場合は、最後に構成されたパスのマッチングがそのコンテンツに適用されます。 例えば、存続時間値 3000 秒で最初に作成された `/example/file` と、存続時間値 4000 秒で後から作成された `/example/*` という 2 つの TTL を検討します。 `/example/file` のほうがより特定的ですが、`/example/*` のほうが後から作成されたので、`/example/file` の TTL は 4000 秒になります。 TTL エントリーは、作成後、パスと時間 (あるいはどちらか) を編集することができます。 パスと時間は削除することもできます。

## グラフィカル・ビューを使用したメトリック
{: #metrics-with-graphical-views}

各 CDN のメトリックは、その CDN マッピングのカスタマー・ポータルにある「概要」タブに表示されます。 2 つのタイプのメトリックが CDN の使用量から計算されます。ある期間にわたるメトリックをグラフで表示したものと、集合値で表示したものです。

ある期間にわたる変化をグラフ表示したメトリックでは、3 つの折れ線グラフと 1 つの円グラフを確認できます。 3 つの折れ線グラフは、**帯域幅**、**マッピング別のヒット**、および**タイプ別のヒット**です。 3 つのグラフは、指定した時間フレームにわたる毎日の活動を表示します。 **帯域幅**と**マッピング別のヒット**のグラフは単線グラフですが、**タイプ別のヒット**の詳細は、提供されるヒット・タイプごとに 1 つの線を示しています。 円グラフは、CDN マッピングについて帯域幅の地域別の詳細を百分率で示しています。

集合値のメトリックには、**帯域幅使用量** (GB)、CDN エッジ・サーバーに対する**総ヒット数**、および**ヒット率**が含まれます。 ヒット率は、コンテンツがオリジンを通してでは_なく_エッジ・サーバーによって配信された回数の割合 (パーセンテージ) を示します。 現行のヒット率は、表示中の 1 つの CDN マッピングではなく、すべての CDN マッピングの関数として表示されます。

デフォルトでは、集合数とグラフの両方で最後の 30 日間分のメトリックが表示されますが、[カスタマー・ポータル![外部リンク・アイコン](../../icons/launch-glyph.svg " 外部リンク・アイコン")](https://control.softlayer.com/)で変更することができます。 両方のカテゴリーで、7 日、15 日、30 日、60 日、または 90 日間のメトリックを表示することができます。

## ホスト・ヘッダーのサポート
{: #host-header-support}

エッジ・サーバーは、オリジン・ホストと通信するときに**ホスト・ヘッダー**を使用します。 この機能により、オリジン・ホストで Web サービスが構成される方法が柔軟になります。 具体的には、クライアントに、同じオリジン・ホストに構成されている複数の Web サーバーがあるユース・ケースが使用可能になります。 ホスト・ヘッダーの入力データが指定されない場合で、オリジン・サーバーがホスト名 (IP アドレスではなく) として指定されると、サービスはデフォルトの HTTP ホスト・ヘッダーとしてオリジン・サーバー・ホスト名を使用します。 ホスト・ヘッダーが入力として指定されず、かつオリジン・サーバーが IP アドレスとして指定される場合は、CDN ホスト名 (CDN ドメイン・ネームとも呼ばれる) がデフォルトの HTTP ホスト・ヘッダーとして使用されます。

## HTTPS プロトコルのサポート
{: #https-protocol-support}

コンテンツを安全にエンド・ユーザーに届けるため、HTTPS プロトコルを使用するように CDN を構成できます。 この構成では、CDN 構成の一環として SSL 証明書のセットアップが必要です。 HTTPS に使用可能な SSL 証明書のオプションとして、[ワイルドカード証明書](/docs/infrastructure/CDN?topic=CDN-about-https#wildcard-certificate-support)と[ドメイン検証 (DV) サブジェクト代替名 (SAN) 証明書](/docs/infrastructure/CDN?topic=CDN-about-https#san-certificate-suport)の 2 つのタイプがあります。 後者のタイプは、この資料では _SAN 証明書_とも呼びます。

使用する SSL 証明書のタイプは、HTTPS CDN の重要な考慮事項の 1 つです。 ワイルドカード証明書の場合、構成セットアップは素早く行えますが、CDN が CNAME の使用によってのみアクセス可能であるというマイナス面があります。 SAN 証明書の場合、処理が完了するまでに 4 時間から 8 時間かかりますが、CDN を CDN ドメイン (つまり、ホスト名) で使用できます。 また、SAN 証明書では、構成時に[**ドメイン制御検証**](/docs/infrastructure/CDN?topic=CDN-completing-domain-control-validation-for-https-with-dv-san)の追加ステップが必要です。 これらの証明書のどちらも、使用に関連するコストはありません。 特定の証明書タイプを選択した場合の影響を理解するには、[トラブルシューティング文書](/docs/infrastructure/CDN?topic=CDN-troubleshooting#what-is-the-expected-behavior-when-loading-the-cname-or-hostname-on-your-browser-for-the-supported-protocols-)を参照してください。

オリジン・ホストは CDN ホスト名のための独自の SSL 証明書を保有している必要もあり、それは承認された認証局 (CA) によって署名されていなければなりません。

信頼の対象となる一連の中間証明書は頻繁に変更されるため、業界のベスト・プラクティスとして、Akamai は中間証明書ではなくルート証明書のみを信頼しています。 Akamai が信頼する証明書は [Web のこの場所](https://community.akamai.com/docs/DOC-4447-ssltls-certificate-chains-for-akamai-managed-certificates)にあります。

## ヘッダーを尊重 (Respect Headers)
{: #respect-headers}

**「ヘッダーを尊重 (Respect Headers)」**オプションにより、オリジンの HTTP ヘッダー構成で CDN 構成をオーバーライドできます。 この機能はデフォルトではオンですが、オフにすることもできます。

## 失効コンテンツの提供
{: #serve-stale-content}

CDN エッジ・サーバーがユーザー要求を受け取り、要求コンテンツがキャッシュに入っていない場合、エッジ・サーバーはコンテンツを取り出すためにオリジン・ホストに到達します。 コンテンツはその後、コンテンツに指定された存続時間 (TTL) の間、キャッシュに入ります。 TTL の有効期限が切れた後にユーザー要求が受け取られると、エッジ・サーバーはコンテンツを取り出すためにオリジン・ホストに到達します。 何らかの理由でオリジン・サーバーに到達できない場合 (オリジン・ホストがダウンしている、ネットワークの問題がある、など) は、エッジ・サーバーは期限切れの (失効した) コンテンツを要求に提供します。 この機能は Akamai によってサポートされており、オフにすることは**できません**。

## キャッシュ・キーの最適化
{: #cache-key-optimization}

Akamai エッジ・サーバーは、**キャッシュ・ストア**にコンテンツをキャッシュします。 エッジ・サーバーは、**キャッシュ・ストア**からのコンテンツを使用するために、**キャッシュ・キー**を使用します。 通常、**キャッシュ・キー**は、エンド・ユーザーの URL の一部に基づいて生成されます。 URL には、ユーザーごとに異なる照会関数引数が含まれている場合もありますが、配信されるコンテンツは同じです。 デフォルトでは、Akamai は照会関数の引数を使用してキャッシュ・キーを生成するため、結果として各ユーザーに固有のキャッシュ・キーを生成します。 このメソッドは最適ではありません。このメソッドでは、すでにキャッシュに入っていて異なるキャッシュ・キーを使用するコンテンツのために、エッジ・サーバーがオリジン・サーバーに接続することになるからです。 **「キャッシュ・キーの最適化」**機能により、キャッシュ・キーを生成するときにどの照会引数を含め、どの照会引数を無視するかを指定できます。この機能は、オリジン・パスの`作成`と`更新`、および CDN マッピング構成の`作成`と`更新`に適用されます。

**「キャッシュ・キーの最適化」**の値は、CDN マッピングの作成後に**「設定」**タブから構成できます。オリジン・パスについては、オリジン・パスの`作成`または`更新`操作中にそれらを構成できます。
{: note}

## コンテンツ圧縮
{: #content-compression}

Akamai CDN では、以下のコンテンツ・タイプに対して**コンテンツ圧縮**がデフォルトで有効になります。
* text/html*
* text/css*
* text/xml*
* text/json
* text/javascript*
* text/plain*
* application/x-javascript*
* application/json
* application/xml*

圧縮がエッジ・サーバーによって処理される場合、コンテンツは少なくとも 10 KB である必要があります。  圧縮がオリジン・サーバーで処理される場合もあり、その場合、圧縮されるファイルのサイズに制限はありません。 オリジン・サーバーによってコンテンツがすでに圧縮されている場合は、再度圧縮されることはありません。 コンテンツ圧縮を使用可能にするには、要求ヘッダーが `Accept-Encoding: gzip` を定義する必要があります。

## ラージ・ファイルの最適化
{: #large-file-optimization}

ラージ・ファイルの最適化により、CDN ネットワークは 10 MB より大きいコンテンツの配信を最適化することができます。 これにより、ラージ・ファイルのパフォーマンスが向上し、待ち時間とダウンロード時間が削減されます。 この機能を使用しないと、CDN は 1.8 GB より大きいサイズのファイルを提供することができません。 この機能により、1.8 GB より大きいファイルのダウンロードが最大 320 GB まで可能になります。

ラージ・ファイルの最適化を機能させるには、オリジン・サーバーでバイト範囲の要求を使用可能にする**必要があります**。Akamai CDN は、この最適化に_部分オブジェクト・キャッシング_と呼ばれる技術を採用しています。ラージ・ファイルが要求されると、エッジ・サーバーは、ファイルがサイズ要件に見合っているかどうかを確認します。 これは、10 MB より大きいファイルは、オリジン・サーバーからチャンクで要求されることを意味します。チャンクがエッジ・サーバーに到着すると、キャッシュに入れられてすぐにユーザーに提供されます。 次のチャンクは、エッジ・サーバーによって並行してプリフェッチされるため、待ち時間が削減されます。 このプロセスは、ファイル全体が取得されるまで、または接続が終了するまで続きます。

この機能が使用可能になると、10 MB より小さいコンテンツの提供に関連したパフォーマンス・コストがわずかに発生します。 そのため、この機能はラージ・ファイルのサービス提供をする場合にのみ推奨します。 CDN 構成で新規のオリジン・パスを作成し、そのパスのラージ・ファイルの最適化を有効にするのが典型的なユース・ケースです。

## ビデオ・オンデマンド
{: #video-on-demand}

**ビデオ・オンデマンド**のパフォーマンス最適化は、多様なネットワーク・タイプにわたり高品質のストリーミングを配信します。 事前構成済みのキャッシュ制御設定、および負荷を動的に分散する分散ネットワークの機能を使用することで、IBM Cloud CDN with Akamai では、計画の有無にかかわらず、大規模なオーディエンスに対応した急激な拡大が可能です。

**ビデオ・オンデマンド**は、HLS、DASH、HDS、HSS などのセグメント化されたストリーミング形式の分散に対して最適化されます。 ライブ・ビデオ・ストリーミングは、この時点ではサポートされて**いません**。 「設定」タブの**「最適化 (Optimize for)」**にあるドロップダウン・メニューでオプションを選択するか、新規のオリジン・パスの作成時に、**ビデオ・オンデマンド**機能を有効にできます。 この機能は、ビデオ・ファイルの配信を最適化する場合にのみ有効にします。

## 地理的アクセス制御
{: #geographical-access-control}

地理的アクセス制御は、ユーザーの地理的位置に基づいて、ユーザーのグループに `access-type` パラメーターを設定できるようにするルール・ベースの動作です。 **Allow** と **Deny** の 2 つのタイプの動作を使用できます。

アクセス・タイプを `Allow` にすると、地域のタイプに基づいて、選択した地域へのトラフィックを明確に許可できます。 特定の地域のトラフィックを許可することで、その他すべての地域のトラフィックが暗黙的にブロックされます。 例えば、選択した大陸 (ヨーロッパやオセアニアなど) へのトラフィックを許可するように選択でき (`Allow`)、そうすると、その他すべての大陸のアクセスはブロックされます。

一方、`Deny` の動作は、指定された地域の、サービスへのアクセスをブロックします。しかし、指定されていないその他すべての地域については、アクセスを許可します。 例えば、ヨーロッパ大陸とオセアニア大陸に対し、地理的アクセス制御のアクセス・タイプを `Deny` に設定した場合、それらの大陸のユーザーはサービスを使用**できなくなります**が、その他すべての大陸のユーザーはサービスにアクセスできます。

この機能には、CDN 構成の**「設定」**ページからアクセスできます。

## ホット・リンク保護
{: #hotlink-protection}

ホット・リンク保護はルール・ベースの動作で、これにより、特定の Web サイトに、CDN からのコンテンツへのアクセスを許可するかどうかを制御できます。Web ページのリンクから HTTP 要求が行われる際に、そのリンクがリモート・アセットを指している場合、ブラウザーは通常 `Referer` ヘッダーを含めます。ある Web サイトが別の Web サイトのアセットにアクセスするために使用するリンクは、_ホット・リンク_と呼ばれます。**ALLOW** と **DENY** という 2 つのタイプの動作が使用可能です。

`protectionType` が `ALLOW` に設定されている場合は、以下のようになります。
* CDN に送信された要求内の `Referer` ヘッダーの値が、指定された `refererValues` のいずれかに一致すると、CDN は要求されたコンテンツを提供**します**。
* そうでない場合、CDN はコンテンツを提供**しません**。

`protectionType` が `DENY` に設定されている場合は、以下のようになります。
* CDN に送信された要求内の `Referer` ヘッダーの値が、指定された `refererValues` のいずれかに一致すると、CDN は要求されたコンテンツを提供**しません**。
* そうでない場合、CDN はコンテンツを提供します。
